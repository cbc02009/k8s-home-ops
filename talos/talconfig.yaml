---
clusterName: kokoro
talosVersion: v1.3.2
kubernetesVersion: v1.26.0
endpoint: https://10.0.0.15:6443
domain: cluster.local
allowSchedulingOnMasters: true
additionalMachineCertSans:
  - 10.0.0.15
additionalApiServerCertSans:
  - cluster.local
clusterPodNets:
  - 10.11.0.0/16
clusterSvcNets:
  - 10.10.0.0/16
cniConfig:
  name: none
nodes:

  - hostname: Anya
    ipAddress: 10.0.0.9
    installDiskSelector:
      model: KingFast
    controlPlane: true
    disableSearchDomain: true
    kernelModules:
      - name: br_netfilter
        parameters:
          - nf_conntrack_max=131072
    nameservers:
      - 10.0.0.90
    networkInterfaces:
      - interface: eth0
        addresses:
          - 10.0.0.9/23
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
        vip:
          ip: 10.0.0.15

  - hostname: Rem
    ipAddress: 10.0.0.13
    installDiskSelector:
      model: FPT310M8SSD256G
    controlPlane: true
    disableSearchDomain: true
    kernelModules:
      - name: br_netfilter
        parameters:
          - nf_conntrack_max=131072
    nameservers:
      - 10.0.0.90
    networkInterfaces:
      - interface: eth0
        addresses:
          - 10.0.0.13/23
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
        vip:
          ip: 10.0.0.15

  - hostname: Ram
    ipAddress: 10.0.0.14
    installDiskSelector:
      model: FPT310M8SSD256G
    controlPlane: true
    disableSearchDomain: true
    kernelModules:
      - name: br_netfilter
        parameters:
          - nf_conntrack_max=131072
    nameservers:
      - 10.0.0.90
    networkInterfaces:
      - interface: eth0
        addresses:
          - 10.0.0.14/23
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
        vip:
          ip: 10.0.0.15

  - hostname: Sakura
    ipAddress: 10.0.0.12
    installDiskSelector:
      model: INTEL SSDPEKNW512G8
    controlPlane: true
    disableSearchDomain: true
    kernelModules:
      - name: br_netfilter
        parameters:
          - nf_conntrack_max=131072
    nameservers:
      - 10.0.0.90
    networkInterfaces:
      - interface: eth0
        addresses:
          - 10.0.0.12/23
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
        vip:
          ip: 10.0.0.15

  - hostname: Uiharu
    ipAddress: 10.0.0.10
    installDiskSelector:
      serial: PHKA1261000X1P0B
    controlPlane: true
    disableSearchDomain: true
    kernelModules:
      - name: br_netfilter
        parameters:
          - nf_conntrack_max=131072
    nameservers:
      - 10.0.0.90
    networkInterfaces:
      - interface: eth0
        addresses:
          - 10.0.0.10/23
        mtu: 1500
        routes:
          - network: 0.0.0.0/0
            gateway: 10.0.0.1
        vip:
          ip: 10.0.0.15


controlPlane:
  patches:
    - |-
      cluster:
        allowSchedulingOnMasters: true
        controllerManager:
          extraArgs:
            feature-gates: MixedProtocolLBService=true,EphemeralContainers=True
        discovery:
          registries:
            service:
              disabled: true
        proxy:
          disabled: true
          extraArgs:
            feature-gates: MixedProtocolLBService=true,EphemeralContainers=True
        scheduler:
          extraArgs:
            feature-gates: MixedProtocolLBService=true,EphemeralContainers=True
      machine:
        kubelet:
          extraArgs:
            feature-gates: GracefulNodeShutdown=true,MixedProtocolLBService=true
            rotate-server-certificates: "true"
        sysctls:
          fs.inotify.max_user_watches: "1048576"
          fs.inotify.max_user_instances: "8192"
        time:
          disabled: false
          servers:
            - time.cloudflare.com
          bootTimeout: 2m0s
    - |-
      - op: remove
        path: /cluster/apiServer/admissionControl
